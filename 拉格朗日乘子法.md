# 拉格朗日乘子法

## 1.优化问题

+ 无约束优化
  $$
  min\qquad f(x)
  $$

+ 有约束优化
  $$
  \begin{aligned}
  min\qquad&f(x)\\
  s.t.\qquad&h_i(x)\leq0,i=1,2,...n\\
  &g_j(x)=0,j=1,2,...,m
  \end{aligned}
  $$
  
+ 对于不等式约束h(x)的曲面上每一个点都存在梯度方向$\Delta h(x)$，沿着这个方向梯度增大，反向梯度减小，这两个方向记做：
  $$
  N^+_h(x)=\{\lambda h(x),\lambda\geq0\}\\
  N_h^-(x)=\{\lambda h(x), \lambda\leq0\}\\
  $$

而这点的切平面张成了一个n-1维子空间，记做$T_h(x)$

假设可行域中的极值点为$x^*$，给定一个优化问题，我们把满足所有约束条件的n维空间区域称为可行域。从可行域中的每一个点x朝某个方向v出发走一点点，如果还在可行域中，或者偏离可行域的程度很小，准确地说，偏移量是行进距离的高阶无穷小量，那么我们就说v是一个可行方向。

+ 如果约束为$h(x)\leq0$，且$x^*$满足$h(x^*)<0$，说明它在曲线h(x)的某一侧，并且不再边界上，因此可行方向是$R^n$，$x^*$称为内部解，不等式约束问题退化为无约束优化，且满足$\Delta f=0,\lambda=0$
  + 如果约束为$h(x)\leq0$而$x^*$满足$h(x^*)=0$，说明可行方向是切平面$T_h$，保持在g(x)=0上移动，也可以往$N_h^+$的方向走，但是不能走$N_h^-$方向，因为这样就违背了$h(x)\leq0$的约束，$x^*$称为边界解，因此满足$g(x^*)=0$
  
  故，在不等式约束中，要求：$\lambda \leq 0$，但是在等式约束中就没有这个约束，并且这两种情况都满足：$\lambda g(x)=0$
  
+ 拉格朗日函数求解极值的KKT条件(等式约束问题只需要满足拉格朗日取极值的必要条件即可)：

  + 拉格朗日取极值的必要条件(偏导为0)
  + 拉格朗日系数约束，也叫对偶问题约束($\lambda\geq0,\mu\not=0$)
  + 互补松弛条件($\lambda g(x)=0$)
  + 原约束条件($h_i(x)=0,g_j(x)\leq0$)



## 2.拉格朗日对偶性

首先引进广义拉格朗日函数：
$$
L(x, \lambda, \mu)=f(x)+\sum_{i=1}^k\lambda_i h_i(x)+\sum_{j=1}^l\mu_jg_j(x)
$$
求出满足KKT条件的解即为所求。但是KKT条件是线性不等式组，计算起来不方便，于是引入了对偶的方法求解。将原问题记做P，下面引入一个新的表达式，拉格朗日极小极大问题：

假设f(x)是凸函数，那么$L(x, \lambda, \mu)$是关于$x$的凸函数，关于$\lambda,\mu$的线性函数，由于x满足约束条件，那么$h_i(x)=0$，$g_j(x)\leq0$，并且满足$\mu_j\geq0$,所以第二项被抵消，第三项小于等于0，因此在约束条件下$L(x, \lambda, \mu)\leq f(x)$，也就是说$L(x,\lambda,\mu)$关于$\lambda, \mu$在约束条件下是有上界的，最小值是负无穷，所以可以先对$L(x,\lambda, \mu)$取最大值(这就是为什么先要取最大值，从优化目标的角度考虑，我们的优化目标是x而不是$\lambda, \mu$，因此进行的操作是先将变量$\lambda,\mu$消除，然后求出x而不是先消除变量x)，即：
$$
\theta_P=\max_{\lambda\mu;\mu_i\geq0}L(x, \lambda, \mu)>L(x,\lambda, \mu)
$$
这是x满足约束的情况，如果x不满足约束时，由于$L(x,\lambda, \mu)$是关于$\lambda, \mu$的线性函数，$L(x, \lambda, \mu)$的最大值就是无穷大。故：
$$
P'=\max_{\lambda\mu;\mu_j\geq0}L(x,\lambda,\mu)=\left\{\begin{aligned}&f(x),\qquad (h_i(x)=0,g_j(x)\leq0)\\&\infin\end{aligned}\right.
$$
所以在满足约束条件时，$\theta_p$就是优化目标函数$f(x)$，再对其求最小值就等价于原问题；当不满足约束条件时，就相当于求无穷大的最小值，也就无解。记原始问题的解为：$p^*$，则这两个问题等价：
$$
\min_x f(x)=\min_x\max_{\lambda\mu;\mu_j\geq0}L(x,\lambda,\mu)
$$

+ 拉格朗日极大极小问题又叫原始问题：
  $$
  \min_x\max_{\lambda\mu;\mu_j\geq0}L(x,\lambda,\mu)
  $$

+ 定义对偶函数：
  $$
  D(\lambda, \mu)=\min_{x}L(x,\lambda,\mu)
  $$
  有了对偶函数，就可以写出对偶问题：
  $$
  \max_{\lambda\mu;\mu_j\geq0}\min_xL(x,\lambda, \mu)
  $$
  假设对偶问题的最优解为$d^*$，如果原问题中，$f(x)$不是凸函数，原始问题和对偶问题的最优解并不相等，满足如下关系：
  $$
  d^*\leq p^*
  $$
  **证明**：

  由定义可知，在满足约束条件时：
  $$
  D(\lambda,\mu)=\min_xL(x,\lambda,\mu)\leq L(x,\lambda,\mu)\leq \max_{\lambda\mu;\mu_j\geq0}L(x,\lambda,\mu)=f(x)
  $$
  可以推出：
  $$
  D(\lambda, \mu)\leq f(x)
  $$
  自然可以得出：
  $$
  d^*=\max_{\lambda\mu;\mu_j\geq0}L(x,\lambda,\mu)\leq \min_xf(x)=p^*
  $$
  这就是**弱对偶性**，对任意的$f(x)$都成立；与弱对偶性对立的是**强对偶性**，也就是$d^*=p^*$，强对偶性需要满足某些条件才可以。
  
+ 满足强对偶性所需条件：
  
+ Slater条件：
  
  若原问题为凸优化问题，且存在严格约束条件的点(“严格约束”指的是$g_j(x)\leq0$中的$\leq$严格取到<)，也即存在x满足$g_j(x)<0$，则强对偶性成立
  
+ KKT条件：
  
  原问题不一定是凸优化问题，只要满足KKT条件，强对偶就成立
  

  
  
  
  
  
  
  
  
  
  
  
  















