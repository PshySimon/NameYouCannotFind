# å‰é¦ˆç¥ç»ç½‘ç»œ

## 1.æ¿€æ´»å‡½æ•°

**æ¿€æ´»å‡½æ•°** 

æ¿€æ´»å‡½æ•°åœ¨ç¥ç»å…ƒä¸­éå¸¸é‡è¦çš„ï¼ä¸ºäº†å¢å¼ºç½‘ç»œçš„è¡¨ç¤ºèƒ½åŠ›å’Œå­¦ä¹ èƒ½åŠ›ï¼Œæ¿€æ´»å‡½æ•°éœ€è¦å…·å¤‡ä»¥ä¸‹å‡ ç‚¹æ€§è´¨ï¼š 

ï¼ˆ1ï¼‰ è¿ç»­å¹¶å¯å¯¼ï¼ˆå…è®¸å°‘æ•°ç‚¹ä¸Šä¸å¯å¯¼ï¼‰çš„éçº¿æ€§å‡½æ•°ï¼å¯å¯¼çš„æ¿€æ´»å‡½æ•°å¯ä»¥ç›´æ¥åˆ©ç”¨æ•°å€¼ä¼˜åŒ–çš„æ–¹æ³•æ¥å­¦ä¹ ç½‘ç»œå‚æ•°ï¼ 

ï¼ˆ2ï¼‰ æ¿€æ´»å‡½æ•°åŠå…¶å¯¼å‡½æ•°è¦å°½å¯èƒ½çš„ç®€å•ï¼Œæœ‰åˆ©äºæé«˜ç½‘ç»œè®¡ç®—æ•ˆç‡ï¼ 

ï¼ˆ3ï¼‰ æ¿€æ´»å‡½æ•°çš„å¯¼å‡½æ•°çš„å€¼åŸŸè¦åœ¨ä¸€ä¸ªåˆé€‚çš„åŒºé—´å†…ï¼Œä¸èƒ½å¤ªå¤§ä¹Ÿä¸èƒ½å¤ªå°ï¼Œå¦åˆ™ä¼šå½±å“è®­ç»ƒçš„æ•ˆç‡å’Œç¨³å®šæ€§ï¼

### 1.1 Sigmoidå‡½æ•°

$$
\sigma(x)=\frac{1}{1+exp(-x)}
$$

Logistic å‡½æ•°å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªâ€œæŒ¤å‹â€å‡½æ•°ï¼ŒæŠŠä¸€ä¸ªå®æ•°åŸŸçš„è¾“å…¥â€œæŒ¤å‹â€åˆ°(0, 1)ï¼å½“è¾“å…¥å€¼åœ¨0é™„è¿‘æ—¶ï¼ŒSigmoidå‹å‡½æ•°è¿‘ä¼¼ä¸ºçº¿æ€§å‡½æ•°ï¼›å½“è¾“å…¥å€¼é è¿‘ä¸¤ç«¯æ—¶ï¼Œå¯¹è¾“å…¥è¿›è¡ŒæŠ‘åˆ¶ï¼è¾“å…¥è¶Šå°ï¼Œè¶Šæ¥è¿‘äº 0ï¼›è¾“å…¥è¶Šå¤§ï¼Œè¶Šæ¥è¿‘äº 1ï¼å’Œæ„ŸçŸ¥å™¨ä½¿ç”¨çš„é˜¶è·ƒæ¿€æ´»å‡½æ•°ç›¸æ¯”ï¼ŒLogisticå‡½æ•°æ˜¯è¿ç»­å¯å¯¼çš„ï¼Œå…¶æ•°å­¦æ€§è´¨æ›´å¥½ï¼å› ä¸ºLogisticå‡½æ•°çš„æ€§è´¨ï¼Œä½¿å¾—è£…å¤‡äº†Logisticæ¿€æ´»å‡½æ•°çš„ç¥ç»å…ƒå…·æœ‰ä»¥ä¸‹ä¸¤ç‚¹æ€§è´¨ï¼š

1ï¼‰å…¶è¾“å‡ºç›´æ¥å¯ä»¥çœ‹ä½œæ¦‚ç‡åˆ†å¸ƒï¼Œä½¿å¾—ç¥ç»ç½‘ç»œå¯ä»¥æ›´å¥½åœ°å’Œç»Ÿè®¡å­¦ä¹ æ¨¡å‹è¿›è¡Œç»“åˆï¼

2ï¼‰å…¶å¯ä»¥çœ‹ä½œä¸€ä¸ªè½¯æ€§é—¨ï¼ˆSoft Gateï¼‰ï¼Œç”¨æ¥æ§åˆ¶å…¶ä»–ç¥ç»å…ƒè¾“å‡ºä¿¡æ¯çš„æ•°é‡ï¼ 



### 1.2 Tanhå‡½æ•°

$$
tanh(x)=\frac{exp(x)-exp(-x)}{exp(x)+exp(-x)}
$$

Tanhå‡½æ•°å¯ä»¥çœ‹ä½œæ”¾å¤§å¹¶å¹³ç§»çš„Logisticå‡½æ•°ï¼Œå…¶å€¼åŸŸæ˜¯(âˆ’1, 1)ï¼tanh(ğ‘¥) = 2ğœ(2ğ‘¥) âˆ’ 1.Tanh å‡½æ•°çš„è¾“å‡ºæ˜¯é›¶ä¸­å¿ƒåŒ–çš„ï¼ˆZero-Centeredï¼‰ï¼Œè€Œ Logistic å‡½æ•°çš„è¾“å‡ºæ’å¤§äº 0ï¼ éé›¶ä¸­å¿ƒåŒ–çš„è¾“å‡ºä¼šä½¿å¾—å…¶åä¸€å±‚çš„ç¥ç»å…ƒçš„è¾“å…¥å‘ç”Ÿåç½®åç§»ï¼ˆBias Shiftï¼‰ï¼Œå¹¶è¿›ä¸€æ­¥ä½¿å¾—æ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ã€‚



### 1.3 ReLUå‡½æ•°

$$
ReLU(x)=\max{(0, x)}
$$

**ä¼˜ç‚¹** 

é‡‡ç”¨ ReLU çš„ç¥ç»å…ƒåªéœ€è¦è¿›è¡ŒåŠ ã€ä¹˜å’Œæ¯”è¾ƒçš„æ“ä½œï¼Œè®¡ç®—ä¸Šæ›´åŠ é«˜æ•ˆï¼Sigmoid å‹æ¿€æ´»å‡½æ•°ä¼šå¯¼è‡´ä¸€ä¸ªéç¨€ç–çš„ç¥ç»ç½‘ç»œï¼Œè€Œ ReLU å´å…·æœ‰å¾ˆå¥½çš„ç¨€ç–æ€§ï¼Œå¤§çº¦50%çš„ç¥ç»å…ƒä¼šå¤„äºæ¿€æ´»çŠ¶æ€ï¼åœ¨ä¼˜åŒ–æ–¹é¢ï¼Œç›¸æ¯”äºSigmoidå‹å‡½æ•°çš„ä¸¤ç«¯é¥±å’Œï¼ŒReLUå‡½æ•°ä¸ºå·¦é¥±å’Œå‡½æ•°ï¼Œä¸”åœ¨ ğ‘¥ > 0 æ—¶å¯¼æ•°ä¸º 1ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†ç¥ç»ç½‘ç»œçš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼ŒåŠ é€Ÿæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦ï¼ 

**ç¼ºç‚¹** 

ReLU å‡½æ•°çš„è¾“å‡ºæ˜¯éé›¶ä¸­å¿ƒåŒ–çš„ï¼Œç»™åä¸€å±‚çš„ç¥ç»ç½‘ç»œå¼•å…¥åç½®åç§»ï¼Œä¼šå½±å“æ¢¯åº¦ä¸‹é™çš„æ•ˆç‡ï¼ReLU ç¥ ç» å…ƒ æŒ‡ é‡‡ ç”¨ReLUä½œä¸ºæ¿€æ´»å‡½æ•°çš„ç¥ç»å…ƒï¼æ­¤å¤–ï¼ŒReLU ç¥ç»å…ƒåœ¨è®­ç»ƒæ—¶æ¯”è¾ƒå®¹æ˜“â€œæ­»äº¡â€ï¼åœ¨è®­ç»ƒæ—¶ï¼Œå¦‚æœå‚æ•°åœ¨ä¸€æ¬¡ä¸æ°å½“çš„æ›´æ–°åï¼Œç¬¬ä¸€ä¸ªéšè—å±‚ä¸­çš„æŸä¸ª ReLU ç¥ç»å…ƒåœ¨æ‰€æœ‰çš„è®­ç»ƒæ•°æ®ä¸Šéƒ½ä¸èƒ½è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆè¿™ä¸ªç¥ç»å…ƒè‡ªèº«å‚æ•°çš„æ¢¯åº¦æ°¸è¿œéƒ½ä¼šæ˜¯0ï¼Œ åœ¨ä»¥åçš„è®­ç»ƒè¿‡ç¨‹ä¸­æ°¸è¿œä¸èƒ½è¢«æ¿€æ´»ï¼è¿™ç§ç°è±¡ç§°ä¸ºæ­»äº¡ ReLU é—®é¢˜ï¼ˆDyingReLU Problemï¼‰ï¼Œå¹¶ä¸”ä¹Ÿæœ‰å¯èƒ½ä¼šå‘ç”Ÿåœ¨å…¶ä»–éšè—å±‚ï¼

## 2.å‰é¦ˆç¥ç»ç½‘ç»œ

| è®°å·                               | å«ä¹‰                     |
| ---------------------------------- | ------------------------ |
| L                                  | ç¥ç»ç½‘ç»œå±‚æ•°             |
| $M_l$                              | ç¬¬lå±‚ç¥ç»å…ƒçš„ä¸ªæ•°        |
| $f_l(\cdot)$                       | ç¬¬lå±‚çš„æ¿€æ´»å‡½æ•°          |
| $W^{(l)}\in R^{M_l\times M_{l-1}}$ | ç¬¬l-1å±‚åˆ°ç¬¬lå±‚çš„æƒé‡çŸ©é˜µ |
| $b^{(l)}\in R^{M_l}$               | ç¬¬l-1å±‚åˆ°ç¬¬lå±‚çš„åç½®     |
| $z_l\in R^{M_l}$                   | ç¬¬lå±‚ç¥ç»å…ƒçš„å‡€è¾“å…¥      |
| $\alpha_l\in R^{M_l}$              | ç¬¬lå±‚ç¥ç»å…ƒçš„è¾“å‡º        |

$$
z^{(l)}=W^{(l)}f_{l-1}(z^{(l-1)})+b^{(l)}
$$

$$
\alpha^{(l)}=f_l(W^{(l)}\alpha^{(l-1)}+b^{(l)})
$$



**é€šç”¨è¿‘ä¼¼å®šç†**ï¼šç¥ç»ç½‘ç»œå¯ä»¥æ‹Ÿåˆä»»æ„ä¸€ä¸ªè¿ç»­å‡½æ•°

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¾“å…¥æ ·æœ¬çš„ç‰¹å¾å¯¹åˆ†ç±»å™¨çš„å½±å“å¾ˆå¤§ï¼ä»¥ç›‘ç£å­¦ä¹ ä¸ºä¾‹ï¼Œå¥½çš„ç‰¹å¾å¯ä»¥æå¤§æé«˜åˆ†ç±»å™¨çš„æ€§èƒ½ï¼å› æ­¤ï¼Œè¦å–å¾—å¥½çš„åˆ†ç±»æ•ˆæœï¼Œéœ€è¦å°†æ ·æœ¬çš„åŸå§‹ç‰¹å¾å‘é‡ğ’™è½¬æ¢åˆ°æ›´æœ‰æ•ˆçš„ç‰¹å¾å‘é‡ğœ™(ğ’™)ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä½œç‰¹å¾æŠ½å–ï¼ 



+ **æ„å»ºè®¡ç®—å›¾è‡ªåŠ¨å¾®åˆ†**ï¼š

  å¯¹å¤åˆå‡½æ•°$f(x;w,b)=\frac{1}{exp(-(wx+b))+1}$æ±‚å¯¼

  é¦–å…ˆæ„é€ è®¡ç®—å›¾ï¼š
  $$
  \begin{aligned}
  h_1&=wx\\
  h_2&=h1+b\\
  h_3&=-h_2\\
  h_4&=exp(h_3)\\
  h_5&=h_4+1\\
  h_6&=\frac{1}{h_5}
  \end{aligned}
  $$
  ç»™å®š$(x=1;w=0,b=0)$

  + å‰å‘æ¨¡å¼æ±‚$\frac{\partial f(x;w,b)}{\partial w}$ï¼š
    $$
    \begin{aligned}
    \frac{\partial h_1}{\partial w}&=x=1\\
    \frac{\partial h_2}{\partial w}&=\frac{\partial h_2}{\partial h_1}\frac{\partial h_1}{\partial w}=1\times 1=1\\
    \frac{\partial h_3}{\partial w}&=\frac{\partial h_3}{\partial h_2}\frac{\partial h_2}{\partial w}=-1\times 1=-1\\
    \frac{\partial h_4}{\partial w}&=\frac{\partial h_4}{\partial h_3}\frac{\partial h_3}{\partial w}=exp(0)\times (-1)=-1\\
    \frac{\partial h_5}{\partial w}&=\frac{\partial h_5}{\partial h_4}\frac{\partial h_4}{\partial w}=1\times(-1)=-1\\
    \frac{\partial h_6}{\partial w}&=\frac{\partial h_6}{\partial h_5}\frac{\partial h_5}{\partial w}=-\frac{1}{2^2}\times(-1)=0.25\\
    \frac{\partial f(x;w,b)}{\partial w}&=\frac{\partial f(x;w,b)}{\partial h_6}\frac{\partial h_6}{\partial w}=1\times 0.25=0.25
    \end{aligned}
    $$

  + åå‘æ¨¡å¼æ±‚$\frac{\partial f(x;w,b)}{\partial w}$
    $$
    \begin{aligned}
    \frac{\partial f(x;w,b)}{\partial h_6}&=1\\
    \frac{\partial f(x;w,b)}{\partial h_5}&=\frac{\partial f(x;w,b)}{\partial h_6}\frac{\partial h_6}{\partial h_5}=1\times (-\frac{1}{2^2})=-0.25\\
    \frac{\partial f(x;w,b)}{\partial h_4}&=\frac{\partial f(x;w,b)}{\partial h_5}\frac{\partial h_5}{\partial h_4}=-0.25\times 1=-0.25\\
    \frac{\partial f(x;w,b)}{\partial h_3}&=\frac{\partial f(x;w,b)}{\partial h_4}\frac{\partial h_4}{\partial h_3}=-0.25\times exp(0)=-0.25\\
    \frac{\partial f(x;w,b)}{\partial h_2}&=\frac{\partial f(x;w,b)}{\partial h_3}\frac{\partial h_3}{\partial h_2}=-0.25\times (-1)=0.25\\
    \frac{\partial f(x;w,b)}{\partial h_1}&=\frac{\partial f(x;w,b)}{\partial h_2}\frac{\partial h_2}{\partial h_1}=0.25\times 1=0.25\\
    \frac{\partial f(x;w,b)}{\partial w}&=\frac{\partial f(x;w,b)}{\partial h_1}\frac{\partial h_1}{\partial w}=0.25\times1=0.25
    \end{aligned}
    $$
    ä¸¤è€…æ¯”è¾ƒï¼Œè®¡ç®—åŒä¸€ä¸ªå‚æ•°çš„å¾®åˆ†çš„æ—¶é—´å¤æ‚åº¦ç›¸åŒï¼Œä½†æ˜¯å‰å‘æ¨¡å¼çš„ä¸­é—´æ­¥éª¤éƒ½æ˜¯å¯¹wæ±‚å¯¼ï¼Œæ²¡æœ‰å¯ä»¥ç”¨äºé“¾å¼æ³•åˆ™é‡å¤è®¡ç®—çš„éƒ¨åˆ†ï¼›è€Œåå‘æ¨¡å¼è®¡ç®—æµ…å±‚ç½‘ç»œçš„å¾®åˆ†æ—¶ï¼Œæ·±å±‚ç½‘ç»œä½œä¸ºä¸­é—´ç»“æœè‡ªåŠ¨è¢«æ±‚å‡ºæ¥äº†ï¼Œæ•ˆç‡æ›´é«˜ã€‚



**åå‘ä¼ æ’­ç®—æ³•**ï¼š

å‡è®¾è¾“å…¥$x=[i_1,i_2]=[0.05, 0.10]$ï¼Œæƒé‡$W_1=[[w_1, w_3],[w_2, w_4]]=[[0.15, 0.25],[0.20, 0.30]],b_1=[0.35]$å’Œ$ W_2=[[w_5, w_7], [w_6, w_8]]=[[0.40, 0.50],[0.45, 0.55]], b_2=[0.60], target=[o_1, o_2]=[0.01, 0.99]$ï¼Œæ¿€æ´»å‡½æ•°éƒ½å–sigmoidå‡½æ•°

+ å‰å‘ä¼ æ’­ï¼š

  ç”±äºåç½®çš„å½¢çŠ¶ä¸º[1, 1]ï¼Œè€Œ$xW$çš„å½¢çŠ¶ä¸º[2, 1]ï¼Œä¸èƒ½ç›¸ä¹˜ï¼Œéœ€è¦åˆ©ç”¨å¹¿æ’­æœºåˆ¶å…ˆå°†åç½®å¤åˆ¶æˆ[2, 1]ä¹‹åæ‰èƒ½ç»§ç»­è®¡ç®—

  $out = \sigma(\sigma(xW_1+b_1)W_2+b_2)=[0.751365069, 0.772928765]$

  è¯¯å·®çš„è®¡ç®—ï¼š

  $E=\frac{1}{2}\sum_{i=1}^n(target_i-out_i)^2=0.298371109$

+ åå‘ä¼ æ’­ï¼š

  é¦–å…ˆæ˜ç¡®å‚æ•°æ˜¯æƒé‡å’Œåç½®ï¼Œä¹Ÿå°±æ˜¯è¿™äº›å‚æ•°éœ€è¦æ±‚å¯¼ï¼Œå…¶ä»–å‚æ•°ä¸éœ€è¦æ±‚å¯¼
  $$
  \begin{aligned}
  E &= \frac{1}{2}(target_1 - out_1)^2+\frac{1}{2}(target_2-out_2)^2\\
  &=\frac{1}{2}(target_1-net_{o1}(out_3))^2+\frac{1}{2}(target_2-net_{o2}(out_4))\\
  &=\frac{1}{2}(target_1-(w_5\times out_3 + w_6\times out_3 + b_2))^2+\frac{1}{2}(target_2-(w_7\times out_4 + w_8\times out_4 + b_2))^2
  \end{aligned}
  $$
  

  ä»åå¾€å‰è®¡ç®—å¯¼æ•°ï¼š
  $$
  \frac{\partial E}{\partial W_2}=
  \left[
      \begin{array}{ccc}
          \frac{\partial E}{\partial w_5}& \frac{\partial E}{\partial w_7} \\
          \frac{\partial E}{\partial w_6} & \frac{\partial E}{\partial w_8} \\
      \end{array}
  \right]
  =
  \left[
      \begin{array}{ccc}
          \frac{\partial E}{\partial out_1}\frac{\partial out_1}{\partial net_{o1}}\frac{\partial net_{o1}}{\partial w_5}& \frac{\partial E}{\partial out_2}\frac{\partial out_2}{\partial net_{o2}}\frac{\partial net_{o2}}{\partial w_7}\\
          \frac{\partial E}{\partial out_1}\frac{\partial out_1}{\partial net_{o1}}\frac{\partial net_{o1}}{\partial w_6}& \frac{\partial E}{\partial out_2}\frac{\partial out_2}{\partial net_{o2}}\frac{\partial net_{o2}}{\partial w_8} \\
      \end{array}
  \right]
  $$
  å…¶ä»–å‚æ•°è®¡ç®—åŒç†ï¼Œé¦–å…ˆå¯ä»¥è®¡ç®—å‡º$[\frac{\partial E}{\partial out_1}, \frac{\partial E}{\partial out_2}]$ï¼Œç„¶åä¾æ¬¡è®¡ç®—$[\frac{\partial out_1}{\partial net_{o1}},\frac{\partial out_2}{\partial net_{o2}}]$ï¼Œæœ€åè®¡ç®—$\frac{\partial net_{o1}}{\partial w_5}, \frac{\partial net_{o1}}{\partial w_6},\frac{\partial net_{o2}}{\partial w_7},\frac{\partial net_{o2}}{\partial w_8}$

## 3. æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±é—®é¢˜

### 3.1 åŸå› 

+ ç¥ç»ç½‘ç»œå±‚æ•°è¿‡å¤š

  ç¥ç»ç½‘ç»œå±‚æ•°è¿‡æ·±ï¼Œæ¢¯åº¦ä¼šè¡°å‡è‡³0
+ ä½¿ç”¨äº†ä¸æ°å½“çš„æ¿€æ´»å‡½æ•°ã€åˆå§‹åŒ–æƒé‡è¿‡å¤§
  
  + ä¸€äº›æ¿€æ´»å‡½æ•°å¦‚ï¼šsigmoidå’Œtanhçš„å¯¼æ•°çš„èŒƒå›´æœ¬èº«å°±æ˜¯å°äº1çš„ï¼Œåœ¨é“¾å¼æ³•åˆ™ä¼ æ’­è¯¯å·®æ—¶ä¼šè¶Šæ¥è¶Šå°



### 3.2 è§£å†³æ–¹æ¡ˆ

+ æ¢¯åº¦è£å‰ª
+ æ”¹ç”¨reluç­‰å…¶ä»–æ¿€æ´»å‡½æ•°
+ batchnorm
+ æ®‹å·®ç»“æ„

+ LSTM

















































